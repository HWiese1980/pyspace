<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pySPACE.missions.nodes.classification.base &mdash; pySPACE documentation</title>
    
    <link rel="stylesheet" href="../../../../../_static/pySPACE.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../../',
        VERSION:     '1.3 release',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../../../_static/pyspace-logo.ico"/>
    <link rel="top" title="pySPACE documentation" href="../../../../../index.html" />
    <link rel="up" title="Module code" href="../../../../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../index.html">pySPACE documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../../index.html">
              <img class="logo" src="../../../../../_static/pyspace-logo_small.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pySPACE.missions.nodes.classification.base</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; Base classes for classification &quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span>

<span class="c1"># import matplotlib as mpl</span>
<span class="c1"># mpl.rcParams[&#39;text.usetex&#39;]=True</span>
<span class="c1"># mpl.rcParams[&#39;text.latex.unicode&#39;]=True</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">cPickle</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">timeit</span>
<span class="c1"># base class</span>
<span class="kn">from</span> <span class="nn">pySPACE.missions.nodes.base_node</span> <span class="kn">import</span> <span class="n">BaseNode</span>
<span class="c1"># representation of the linear classification vector</span>
<span class="kn">from</span> <span class="nn">pySPACE.resources.data_types.feature_vector</span> <span class="kn">import</span> <span class="n">FeatureVector</span>
<span class="c1"># the output is a prediction vector</span>
<span class="kn">from</span> <span class="nn">pySPACE.resources.data_types.prediction_vector</span> <span class="kn">import</span> <span class="n">PredictionVector</span>


<div class="viewcode-block" id="RegularizedClassifierBase"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase">[docs]</a><span class="k">class</span> <span class="nc">RegularizedClassifierBase</span><span class="p">(</span><span class="n">BaseNode</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Basic class for regularized (kernel) classifiers with extra support in</span>
<span class="sd">    the linear case</span>

<span class="sd">    This module also implements several concepts of data handling strategies</span>
<span class="sd">    to keep the set of training samples limited especially in an online</span>
<span class="sd">    learning scenario. These have been used in the *Data Selection Strategies*</span>
<span class="sd">    publication. This functionality is currently implemented for the</span>
<span class="sd">    LibSVMClassifierNode and the SorSvmNode. It requires to replace the</span>
<span class="sd">    *_complete_training*</span>



<span class="sd">    **References**</span>

<span class="sd">        ========= ==============================================================</span>
<span class="sd">        main      source: Data Selection Strategies</span>
<span class="sd">        ========= ==============================================================</span>
<span class="sd">        author    Krell, M. M. and Wilshusen, N. and Ignat, A. C., and Kim, S. K.</span>
<span class="sd">        title     `Comparison of Data Selection Strategies For Online Support Vector Machine Classification &lt;http://dx.doi.org/10.5220/0005650700590067&gt;`_</span>
<span class="sd">        book      Proceedings of the International Congress on Neurotechnology, Electronics and Informatics</span>
<span class="sd">        publisher SciTePress</span>
<span class="sd">        year      2015</span>
<span class="sd">        doi       10.5220/0005650700590067</span>
<span class="sd">        ========= ==============================================================</span>

<span class="sd">    **Parameters**</span>

<span class="sd">        :class_labels:</span>
<span class="sd">            Sets the labels of the classes.</span>
<span class="sd">            This can be done automatically, but setting it will be better,</span>
<span class="sd">            if you want to have similar predictions values</span>
<span class="sd">            for classifiers trained on different sets.</span>
<span class="sd">            Otherwise this variable is built up by occurrence of labels.</span>
<span class="sd">            Furthermore the important class (ir_class) should get the</span>
<span class="sd">            second position in the list, such that it gets higher</span>
<span class="sd">            prediction values by the classifier.</span>

<span class="sd">            (*recommended, default: []*)</span>

<span class="sd">        :complexity:</span>
<span class="sd">            Complexity sets the weighting of punishment for misclassification</span>
<span class="sd">            in comparison to generalizing classification from the data.</span>
<span class="sd">            Value in the range from 0 to infinity.</span>

<span class="sd">            (*optional, default: 1*)</span>

<span class="sd">        :weight:</span>
<span class="sd">            Defines an array with two entries to give different complexity</span>
<span class="sd">            weight on the two used classes.</span>
<span class="sd">            Set the parameter C of class i to weight*C.</span>

<span class="sd">            (*optional, default: [1,1]*)</span>

<span class="sd">        :kernel_type:</span>
<span class="sd">            Defines the used kernel function.</span>
<span class="sd">            One of the following Strings: &#39;LINEAR&#39;, &#39;POLY&#39;,&#39;RBF&#39;, &#39;SIGMOID&#39;.</span>
<span class="sd">            </span>
<span class="sd">            - LINEAR       ::</span>
<span class="sd">            </span>
<span class="sd">                                u&#39;*v</span>
<span class="sd">            - POLY         ::</span>
<span class="sd">            </span>
<span class="sd">                                (gamma*u&#39;*v + offset)^exponent</span>
<span class="sd">            - RBF          ::</span>
<span class="sd">            </span>
<span class="sd">                                exp(-gamma*|u-v|^2)</span>
<span class="sd">            - SIGMOID      ::</span>
<span class="sd">            </span>
<span class="sd">                                tanh(gamma*u&#39;*v + offset)</span>

<span class="sd">            (*optional, default: &#39;LINEAR&#39;*)</span>

<span class="sd">        :exponent:</span>
<span class="sd">            Defines parameter for the &#39;POLY&#39;-kernel.</span>
<span class="sd">            Equals parameter /degree/ in libsvm-package.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: 2*)</span>

<span class="sd">        :gamma:</span>
<span class="sd">            Defines parameter for &#39;POLY&#39;-,&#39;RBF&#39;- and &#39;SIGMOID&#39;-kernel.</span>
<span class="sd">            In libsvm-package it was set to 1/num_features.</span>

<span class="sd">            For RBF-Kernels we calculate it as described in:</span>
<span class="sd">            </span>
<span class="sd">                :Paper:</span>
<span class="sd">                    A practical Approach to Model Selection for Support vector</span>
<span class="sd">                    Machines with a Gaussian Kernel</span>
<span class="sd">                :Author: M. Varewyck and J.-P. Martens.</span>
<span class="sd">                :Formula: 15</span>

<span class="sd">            The quasi-optimal complexity should then be found in [0.5,2,8]</span>
<span class="sd">            or better to say log_2 C should be found in [-1,1,3].</span>
<span class="sd">            For testing a wider range, you may try: [-2,...,4].</span>
<span class="sd">            A less accurate version would be to use 1/(num_features*sqrt(2)).</span>
<span class="sd">            </span>
<span class="sd">            For the other kernels we set it to 1/num_features.</span>
<span class="sd">            </span>
<span class="sd">            .. warning:: </span>
<span class="sd">                 For the RBF-Parameter selection the </span>
<span class="sd">                 the :class:`~pySPACE.missions.nodes.postprocessing.feature_normalization.HistogramFeatureNormalizationNode`</span>
<span class="sd">                 should be used before.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: None*)</span>
<span class="sd">            </span>
<span class="sd">        :offset:</span>
<span class="sd">            Defines parameter for &#39;POLY&#39;- and &#39;SIGMOID&#39;-kernel.</span>
<span class="sd">            Equals parameter /coef0/ in libsvm-package.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: 0*)</span>

<span class="sd">        :nu:</span>
<span class="sd">            Defines parameter for &#39;nu-SVC&#39;, &#39;one-class SVM&#39; and &#39;nu-SVR&#39;. It</span>
<span class="sd">            approximates the fraction of training errors and support vectors.</span>
<span class="sd">            Value in the range from 0 to 1.</span>

<span class="sd">            (*optional, default: 0.5*)</span>

<span class="sd">        :epsilon:</span>
<span class="sd">            Defines parameter for &#39;epsilon-SVR&#39;.</span>
<span class="sd">            Set the epsilon in loss function of epsilon-SVR.</span>
<span class="sd">            Equals parameter /p/ in libsvm-package.</span>

<span class="sd">            (*optional, default: 0.1*)</span>

<span class="sd">        :tolerance:</span>
<span class="sd">            tolerance of termination criterion, same default as in libsvm.</span>
<span class="sd">            </span>
<span class="sd">            In the SOR implementation the tolerance may be reduced to</span>
<span class="sd">            one tenth of the complexity, if it is higher than this value.</span>
<span class="sd">            Otherwise it would be no valid stopping criterion.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: 0.001*)</span>

<span class="sd">        :max_time:</span>
<span class="sd">            Time for the construction of the classifier</span>
<span class="sd">            For LibSVM we restrict the number of steps but for cvxopt</span>
<span class="sd">            we use a signal handling to stop processes.</span>
<span class="sd">            This may happen, when the parameters are bad chosen or </span>
<span class="sd">            the problem matrix is to large.</span>
<span class="sd">            </span>
<span class="sd">            Parameter is still in testing and implementation phase.</span>
<span class="sd">            </span>
<span class="sd">            The time is given in seconds and as a default, one hour is used.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: 3600*)</span>

<span class="sd">        :keep_vectors:</span>
<span class="sd">            After training the training data is normally deleted,</span>
<span class="sd">            except this variable is set to True.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: False*)</span>
<span class="sd">            </span>
<span class="sd">        :use_list:</span>
<span class="sd">            Switch to store samples as *list*. If set to *False* they are stored</span>
<span class="sd">            as arrays. Used for compatibility with LIBSVM. This parameter should</span>
<span class="sd">            not be changed by the user.</span>

<span class="sd">            (*optional, default False*)</span>
<span class="sd">        </span>
<span class="sd">        :multinomial:</span>
<span class="sd">            Accept more than two classes.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: False*)</span>
<span class="sd">        </span>
<span class="sd">        :add_type:</span>
<span class="sd">            In case the classifier should be retrained, this parameter</span>
<span class="sd">            specifies which incoming samples should be added to the training</span>
<span class="sd">            set.</span>
<span class="sd">            One of the following strings &#39;ADD_ALL&#39;, &#39;ONLY_MISSCLASSIFIED&#39;,</span>
<span class="sd">            &#39;ONLY_WITHIN_MARGIN&#39;, &#39;UNSUPERVISED_PROB&#39;.</span>
<span class="sd">            </span>
<span class="sd">            - ADD_ALL</span>
<span class="sd">            </span>
<span class="sd">                Add all incoming samples.</span>
<span class="sd">            </span>
<span class="sd">            - ONLY_MISSCLASSIFIED</span>

<span class="sd">                Add only those samples that were misclassified by the current</span>
<span class="sd">                decision function.</span>
<span class="sd">                                </span>
<span class="sd">                **References**</span>

<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    minor      </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    author    Bordes, Antoine and Ertekin, Seyda and Weston,</span>
<span class="sd">                              Jason and Bottou, L{\&#39;e}on</span>
<span class="sd">                    title     Fast Kernel Classifiers with Online and Active</span>
<span class="sd">                              Learning</span>
<span class="sd">                    journal   J. Mach. Learn. Res.</span>
<span class="sd">                    volume    6</span>
<span class="sd">                    month     dec</span>
<span class="sd">                    year      2005</span>
<span class="sd">                    issn      1532-4435</span>
<span class="sd">                    pages     1579--1619</span>
<span class="sd">                    numpages  41</span>
<span class="sd">                    publisher JMLR.org</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                                </span>
<span class="sd">            - ONLY_WITHIN_MARGIN</span>
<span class="sd">            </span>
<span class="sd">                Add only samples that lie within the margin of</span>
<span class="sd">                the SVM.</span>
<span class="sd">                </span>
<span class="sd">                **References**</span>

<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    main      </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    author    Bordes, Antoine and Ertekin, Seyda and Weston,</span>
<span class="sd">                              Jason and Bottou, L{\&#39;e}on</span>
<span class="sd">                    title     Fast Kernel Classifiers with Online and Active</span>
<span class="sd">                              Learning</span>
<span class="sd">                    journal   J. Mach. Learn. Res.</span>
<span class="sd">                    volume    6</span>
<span class="sd">                    month     dec</span>
<span class="sd">                    year      2005</span>
<span class="sd">                    issn      1532-4435</span>
<span class="sd">                    pages     1579--1619</span>
<span class="sd">                    numpages  41</span>
<span class="sd">                    publisher JMLR.org</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">        </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    main      </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    author    Oskoei, M.A. and Gan, J.Q. and Huosheng Hu</span>
<span class="sd">                    booktitle Engineering in Medicine and Biology Society, 2009.</span>
<span class="sd">                              EMBC 2009. Annual International Conference of the</span>
<span class="sd">                              IEEE</span>
<span class="sd">                    title     Adaptive schemes applied to online SVM for BCI</span>
<span class="sd">                              data classification</span>
<span class="sd">                    year      2009</span>
<span class="sd">                    month     Sept</span>
<span class="sd">                    pages     2600-2603</span>
<span class="sd">                    ISSN      1557-170X</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">    </span>
<span class="sd">            - UNSUPERVISED_PROB</span>

<span class="sd">                Classify the label with the current decision function and</span>
<span class="sd">                determine how probable this decision is. If it is most likely</span>
<span class="sd">                right, which means the probability exceeds a threshold, add the</span>
<span class="sd">                sample to the training set.</span>
<span class="sd">                </span>
<span class="sd">                **References**</span>

<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    main      </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    author    Sp{\&quot;u}ler, Martin and Rosenstiel, Wolfgang and</span>
<span class="sd">                              Bogdan, Martin</span>
<span class="sd">                    year      2012</span>
<span class="sd">                    isbn      978-3-642-33268-5</span>
<span class="sd">                    booktitle Artificial Neural Networks and Machine Learning -</span>
<span class="sd">                              ICANN 2012</span>
<span class="sd">                    volume    7552</span>
<span class="sd">                    series    Lecture Notes in Computer Science</span>
<span class="sd">                    editor    Villa, AlessandroE.P. and Duch, W\lodzis\law and</span>
<span class="sd">                              \&#39;{E}rdi, P\&#39;{e}ter and Masulli, Francesco and</span>
<span class="sd">                              Palm, G{\&quot;u}nther</span>
<span class="sd">                    title     Adaptive SVM-Based Classification Increases</span>
<span class="sd">                              Performance of a MEG-Based Brain-Computer</span>
<span class="sd">                              Interface (BCI)</span>
<span class="sd">                    publisher Springer Berlin Heidelberg</span>
<span class="sd">                    pages     669-676</span>
<span class="sd">                    language  English</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: &quot;ADD_ALL&quot;*)</span>
<span class="sd">        </span>
<span class="sd">        :discard_type:</span>
<span class="sd">            In case the classifier should be retrained this parameter</span>
<span class="sd">            specifies which samples from the training set should be discarded</span>
<span class="sd">            to keep the training set small.</span>
<span class="sd">            One of the following strings &#39;REMOVE_OLDEST&#39;, &#39;REMOVE_FARTHEST&#39;,</span>
<span class="sd">            &#39;REMOVE_NO_BORDER_POINTS&#39;, &#39;INC&#39;, &#39;INC_BATCH&#39;, &#39;CDT&#39;,</span>
<span class="sd">            &#39;DONT_DISCARD&#39;.</span>
<span class="sd">            </span>
<span class="sd">            - REMOVE_OLDEST</span>
<span class="sd">                                    </span>
<span class="sd">                Remove the oldest sample from the training set.</span>
<span class="sd">                                    </span>
<span class="sd">                **References**</span>

<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    main      </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    title     Online weighted LS-SVM for hysteretic structural</span>
<span class="sd">                              system identification</span>
<span class="sd">                    journal   Engineering Structures</span>
<span class="sd">                    volume    28</span>
<span class="sd">                    number    12</span>
<span class="sd">                    pages     1728 - 1735</span>
<span class="sd">                    year      2006</span>
<span class="sd">                    issn      0141-0296</span>
<span class="sd">                    author    He-Sheng Tang and Song-Tao Xue and Rong Chen and</span>
<span class="sd">                              Tadanobu Sato</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">            </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    minor     </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    author    Van Vaerenbergh, S. and Via, J. and Santamaria, I.</span>
<span class="sd">                    booktitle Acoustics, Speech and Signal Processing, 2006.</span>
<span class="sd">                              ICASSP 2006 Proceedings. 2006 IEEE International</span>
<span class="sd">                              Conference on</span>
<span class="sd">                    title     A Sliding-Window Kernel RLS Algorithm and Its</span>
<span class="sd">                              Application to Nonlinear Channel Identification</span>
<span class="sd">                    year      2006</span>
<span class="sd">                    month     May</span>
<span class="sd">                    volume    5</span>
<span class="sd">                    ISSN      1520-6149</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">            </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    minor     </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    author    Funaya, Hiroyuki and Nomura, Yoshihiko</span>
<span class="sd">                              and Ikeda, Kazushi</span>
<span class="sd">                    booktitle ICONIP (1)</span>
<span class="sd">                    date      2009-10-26</span>
<span class="sd">                    editor    K{\&quot;o}ppen, Mario and Kasabov, Nikola K.</span>
<span class="sd">                              and Coghill, George G.</span>
<span class="sd">                    isbn      978-3-642-02489-4</span>
<span class="sd">                    keywords  dblp</span>
<span class="sd">                    pages     929-936</span>
<span class="sd">                    publisher Springer</span>
<span class="sd">                    series    Lecture Notes in Computer Science</span>
<span class="sd">                    title     A Support Vector Machine with Forgetting Factor</span>
<span class="sd">                              and Its Statistical Properties.</span>
<span class="sd">                    volume    5506</span>
<span class="sd">                    year      2008</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    minor     </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    title     On-Line One-Class Support Vector Machines. An</span>
<span class="sd">                              Application to Signal Segmentation</span>
<span class="sd">                    author    Gretton, A and Desobry, F</span>
<span class="sd">                    year      2003</span>
<span class="sd">                    date      2003-04</span>
<span class="sd">                    journal   IEEE ICASSP Vol. 2</span>
<span class="sd">                    pages     709--712</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">        </span>
<span class="sd">            - INC</span>
<span class="sd">                   </span>
<span class="sd">                Don&#39;t remove any sample, but retrain the SVM/classifier</span>
<span class="sd">                incrementally with each incoming sample.</span>
<span class="sd">        </span>
<span class="sd">                **References**</span>

<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    main     </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    year      2012</span>
<span class="sd">                    isbn      978-3-642-34155-7</span>
<span class="sd">                    booktitle Advances in Intelligent Data Analysis XI</span>
<span class="sd">                    volume    7619</span>
<span class="sd">                    series    Lecture Notes in Computer Science</span>
<span class="sd">                    editor    Hollm\&#39;{e}n, Jaakko and Klawonn, Frank</span>
<span class="sd">                              and Tucker, Allan</span>
<span class="sd">                    title     Batch-Incremental versus Instance-Incremental</span>
<span class="sd">                              Learning in Dynamic and Evolving Data</span>
<span class="sd">                    publisher Springer Berlin Heidelberg</span>
<span class="sd">                    author    Read, Jesse and Bifet, Albert and Pfahringer,</span>
<span class="sd">                              Bernhard and Holmes, Geoff</span>
<span class="sd">                    pages     313-323</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">        </span>
<span class="sd">            - CDT</span>
<span class="sd">                   </span>
<span class="sd">                Detect changes in the distribution of the data and adapt the</span>
<span class="sd">                classifier accordingly, by throwing old samples away and only</span>
<span class="sd">                take the last few for retraining.</span>
<span class="sd">        </span>
<span class="sd">                **References**</span>

<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    main     </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    author    Alippi, C. and Derong Liu and Dongbin Zhao</span>
<span class="sd">                              and Li Bu</span>
<span class="sd">                    journal   Systems, Man, and Cybernetics: Systems, IEEE</span>
<span class="sd">                              Transactions on</span>
<span class="sd">                    title     Detecting and Reacting to Changes in Sensing</span>
<span class="sd">                              Units: The Active Classifier Case</span>
<span class="sd">                    year      2014</span>
<span class="sd">                    month     March</span>
<span class="sd">                    volume    44</span>
<span class="sd">                    number    3</span>
<span class="sd">                    pages     353-362</span>
<span class="sd">                    ISSN      2168-2216</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    minor     </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    title     Intelligence for embedded systems: a</span>
<span class="sd">                              methodological approach</span>
<span class="sd">                    author    Cesare Alippi</span>
<span class="sd">                    publisher Springer</span>
<span class="sd">                    address   Cham [u.a.]</span>
<span class="sd">                    year      2014</span>
<span class="sd">                    ISBN      978-3-319-05278-6</span>
<span class="sd">                    pages     211-247</span>
<span class="sd">                    chapter   Learning in Nonstationary and Evolving</span>
<span class="sd">                              Environments</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">        </span>
<span class="sd">            - INC_BATCH</span>
<span class="sd">             </span>
<span class="sd">                Collect new samples until a basket size is reached. Then throw</span>
<span class="sd">                all old samples away. And retrain the classifier with the</span>
<span class="sd">                current training set.</span>
<span class="sd">    </span>
<span class="sd">                **References**</span>

<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    main     </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    year      2012</span>
<span class="sd">                    isbn      978-3-642-34155-7</span>
<span class="sd">                    booktitle Advances in Intelligent Data Analysis XI</span>
<span class="sd">                    volume    7619</span>
<span class="sd">                    series    Lecture Notes in Computer Science</span>
<span class="sd">                    editor    Hollm\&#39;{e}n, Jaakko and Klawonn, Frank</span>
<span class="sd">                              and Tucker, Allan</span>
<span class="sd">                    title     Batch-Incremental versus Instance-Incremental</span>
<span class="sd">                              Learning in Dynamic and Evolving Data</span>
<span class="sd">                    publisher Springer Berlin Heidelberg</span>
<span class="sd">                    author    Read, Jesse and Bifet, Albert</span>
<span class="sd">                              and Pfahringer,Bernhard and Holmes, Geoff</span>
<span class="sd">                    pages     313-323</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">        </span>
<span class="sd">            - DONT_DISCARD</span>

<span class="sd">                Don&#39;t remove any samples from the training set.</span>
<span class="sd">                </span>
<span class="sd">            - REMOVE_FARTHEST</span>

<span class="sd">                Remove that sample that is farthest away from the hyperplane.</span>
<span class="sd">                </span>
<span class="sd">            - REMOVE_NO_BORDER_POINTS</span>

<span class="sd">                Remove all points that are not in the border of their class.</span>
<span class="sd">        </span>
<span class="sd">                **References**</span>

<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    main     </span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">                    title     Incremental SVM based on reserved set for network</span>
<span class="sd">                              intrusion detection</span>
<span class="sd">                    journal   Expert Systems with Applications</span>
<span class="sd">                    volume    38</span>
<span class="sd">                    number    6</span>
<span class="sd">                    pages     7698 - 7707</span>
<span class="sd">                    year      2011</span>
<span class="sd">                    issn      0957-4174</span>
<span class="sd">                    author    Yang Yi and Jiansheng Wu and Wei Xu</span>
<span class="sd">                    ========= ==================================================</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: &quot;REMOVE_OLDEST&quot;*)</span>
<span class="sd">        </span>
<span class="sd">        :keep_only_sv:</span>
<span class="sd">            Because only the support vectors determine the decision function</span>
<span class="sd">            remove all other samples after the SVM is trained.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: False*)</span>
<span class="sd">        </span>
<span class="sd">        :basket_size:</span>
<span class="sd">            Specify the number of training samples for retraining.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: infinity*)</span>
<span class="sd">        </span>
<span class="sd">        :relabel:</span>
<span class="sd">            Relabel the training set after the SVM is trained.</span>
<span class="sd">            If the parameter is set to *True*, the relabeling is done once.</span>
<span class="sd">            Otherwise, if the parameter is set to *conv*</span>
<span class="sd">            relabeling is repeated till convergence (with a maximum of</span>
<span class="sd">            10 iterations over the complete training data to ensure stopping).</span>
<span class="sd">            The maximum number of iterations is reset after each relabeling.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: False*)</span>

<span class="sd">        :border_handling:</span>
<span class="sd">            Specify how to determine border points in case the discard_type: </span>
<span class="sd">            &#39;REMOVE_ONLY_BORDER_POINTS&#39; is selected.</span>
<span class="sd">            One of the following strings &#39;USE_ONLY_BORDER_POINTS&#39;,</span>
<span class="sd">            &#39;USE_DIFFERENCE&#39;.</span>
<span class="sd">            </span>
<span class="sd">            - USE_ONLY_BORDER_POINTS</span>

<span class="sd">                Keep only those points which distance to the center lie within</span>
<span class="sd">                a specified range.</span>
<span class="sd">                </span>
<span class="sd">            - USE_DIFFERENCE</span>

<span class="sd">                Use the difference from the center of the class as criterion</span>
<span class="sd">                to determine the border points of the class.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: USE_ONLY_BORDER_POINTS*)</span>
<span class="sd">        </span>
<span class="sd">        :scale_factor_small:</span>
<span class="sd">            Factor to specify the distance of the inner border to the center</span>
<span class="sd">            of a class.</span>
<span class="sd">            </span>
<span class="sd">            This should be smaller than *scale_factor_tall*. ::</span>
<span class="sd">            </span>
<span class="sd">                inner border = scale_factor_small * distance between centers</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: 0.3*)</span>
<span class="sd">        </span>
<span class="sd">        :scale_factor_tall:</span>
<span class="sd">            Factor to specify the distance of the outer border to the center</span>
<span class="sd">            of a class.</span>
<span class="sd">            </span>
<span class="sd">            This should be greater than *scale_factor_small*. ::</span>
<span class="sd">                </span>
<span class="sd">                outer border = scale_factor_tall * distance between centers</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: 0.5*)</span>
<span class="sd">        </span>
<span class="sd">        :p_threshold:</span>
<span class="sd">            Probability threshold for unsupervised learning. Only data that is</span>
<span class="sd">            most likely right (p&gt;p_threshold) classified will be added to</span>
<span class="sd">            training set.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: 0.8*)</span>
<span class="sd">        </span>
<span class="sd">        :cdt_threshold:</span>
<span class="sd">            Specify a multiple of the amount of support vectors before the SVM</span>
<span class="sd">            should be retrained anyway, does not matter if something changed or</span>
<span class="sd">            not.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: 10*) </span>
<span class="sd">        </span>
<span class="sd">        :training_set_ratio:</span>
<span class="sd">            Handle the ratio of the classes. One of the following strings:</span>
<span class="sd">            &quot;DONT_HANDLE_RATIO&quot;, &quot;KEEP_RATIO_AS_IT_IS&quot;, &quot;BALANCED_RATIO&quot;</span>
<span class="sd">            </span>
<span class="sd">            - DONT_HANDLE_RATIO</span>
<span class="sd">            </span>
<span class="sd">                Dont handle the ratio between the classes and dont consider</span>
<span class="sd">                the class labels of the samples.</span>
<span class="sd">                </span>
<span class="sd">            - KEEP_RATIO_AS_IT_IS</span>
<span class="sd">            </span>
<span class="sd">                Dont change the ratio between the classes. If a sample from one</span>
<span class="sd">                class is added an other sample from the same class will be</span>
<span class="sd">                removed from the training set.</span>
<span class="sd">            </span>
<span class="sd">            - BALANCED_RATIO</span>
<span class="sd">            </span>
<span class="sd">                Try to keep a balanced training set with just as many positive</span>
<span class="sd">                samples as negatives.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: DONT_HANDLE_RATIO&quot;*)</span>

<span class="sd">        :u_retrain:</span>
<span class="sd">            For the retraining, not the given label is used but it is replaced</span>
<span class="sd">            with the prediction of the current classifier. This option is</span>
<span class="sd">            interesting, where no true label can be provided and a fake label</span>
<span class="sd">            is used instead. It is related to the parameter *p_threshold* and</span>
<span class="sd">            the *relabel* parameter. The latter allows for a correction of the</span>
<span class="sd">            possibly wrong label and the first avoids to use to</span>
<span class="sd">            unsure predictions</span>

<span class="sd">            The *retrain* parameter has to be additionally set to *True* for</span>
<span class="sd">            this parameter to become really active.</span>

<span class="sd">            (*optional, default: False*)</span>

<span class="sd">        :show_plot:</span>
<span class="sd">            Plot the samples and the decision function.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: False*)</span>
<span class="sd">        </span>
<span class="sd">        :save_plot:</span>
<span class="sd">            Save the plot of the samples and the decision function.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: False*)</span>
<span class="sd">        </span>
<span class="sd">        :plot_storage:</span>
<span class="sd">            Specify a directory to store the images of the plots.</span>
<span class="sd">            If directory does not exists, it will be created.</span>
<span class="sd">            </span>
<span class="sd">            (*optional, default: &quot;./plot_storage&quot;*)</span>
<span class="sd">            </span>
<span class="sd">    </span>
<span class="sd">    .. note:: Not all parameter effects are implemented for all inheriting</span>
<span class="sd">              nodes. Kernels are available for LibSVMClassifierNode and</span>
<span class="sd">              partially for other nodes.</span>
<span class="sd">              The *tolerance* has only an effect on Liblinear, LibSVM and SOR</span>
<span class="sd">              classifier.</span>

<span class="sd">    :input:    FeatureVector</span>
<span class="sd">    :output:   PredictionVector</span>
<span class="sd">    :Author:   Mario Krell (mario.krell@dfki.de)</span>
<span class="sd">    :Created:  2012/03/28</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="RegularizedClassifierBase.__init__"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">regression</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">complexity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">kernel_type</span><span class="o">=</span><span class="s1">&#39;LINEAR&#39;</span><span class="p">,</span>
                 <span class="n">exponent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                 <span class="n">class_labels</span><span class="o">=</span><span class="p">[],</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">max_time</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
                 <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
                 <span class="n">complexities_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">keep_vectors</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">use_list</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">multinomial</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">add_type</span><span class="o">=</span><span class="s2">&quot;ADD_ALL&quot;</span><span class="p">,</span>
                 <span class="n">discard_type</span><span class="o">=</span><span class="s2">&quot;REMOVE_OLDEST&quot;</span><span class="p">,</span>
                 <span class="n">keep_only_sv</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">basket_size</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
                 <span class="n">relabel</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">border_handling</span><span class="o">=</span><span class="s2">&quot;USE_ONLY_BORDER_POINTS&quot;</span><span class="p">,</span>
                 <span class="n">scale_factor_small</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                 <span class="n">scale_factor_tall</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="n">p_threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                 <span class="n">show_plot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">save_plot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">cdt_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">u_retrain</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">training_set_ratio</span><span class="o">=</span><span class="s2">&quot;DONT_HANDLE_RATIO&quot;</span><span class="p">,</span>
                 <span class="n">plot_storage</span><span class="o">=</span><span class="s2">&quot;./plot_storage&quot;</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">RegularizedClassifierBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># type conversion</span>
        <span class="n">complexity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">complexity</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">complexity</span><span class="o">&lt;</span><span class="mf">1e-10</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s2">&quot;Complexity (</span><span class="si">%.42f</span><span class="s2">) is very small.&quot;</span><span class="o">+</span>\
                      <span class="s2">&quot;Try rescaling data or check this behavior.&quot;</span>\
                      <span class="o">%</span> <span class="n">complexity</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_retrainable</span><span class="p">()</span> <span class="ow">or</span> <span class="n">basket_size</span> <span class="o">!=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
            <span class="n">keep_vectors</span><span class="o">=</span><span class="bp">True</span>
        
        <span class="c1">################ Only for printing ###########################</span>
        <span class="n">is_plot_active</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">scat</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">scatStandard</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">scatTarget</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">surf</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">is_retraining</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">is_trained</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="n">circleTarget0</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">circleTarget1</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">circleStandard0</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">circleStandard1</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">m_counter_i</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1">################# Only to store results ########################</span>
        <span class="k">if</span> <span class="n">save_plot</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show_plot</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
            <span class="c1"># Create storage folder if it does not exists</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">time</span>
                <span class="n">plot_storage</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y_%H_%M_%S&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">plot_storage</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_storage</span><span class="p">):</span>
                    <span class="k">pass</span>  <span class="c1"># Path should already exists</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span>  <span class="c1"># Error on creation</span>
        <span class="c1">################################################################</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">set_permanent_attributes</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                      <span class="n">future_samples</span><span class="o">=</span><span class="p">[],</span> <span class="n">future_labels</span><span class="o">=</span><span class="p">[],</span>
                                      <span class="n">classes</span><span class="o">=</span><span class="n">class_labels</span><span class="p">,</span>
                                      <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span>
                                      <span class="n">kernel_type</span><span class="o">=</span><span class="n">kernel_type</span><span class="p">,</span>
                                      <span class="n">complexity</span><span class="o">=</span><span class="n">complexity</span><span class="p">,</span>
                                      <span class="n">exponent</span><span class="o">=</span><span class="n">exponent</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span>
                                      <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="n">nu</span><span class="p">,</span>
                                      <span class="n">epsilon</span><span class="o">=</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
                                      <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span>
                                      <span class="n">w</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                      <span class="n">feature_names</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                      <span class="n">complexities_path</span><span class="o">=</span><span class="n">complexities_path</span><span class="p">,</span>
                                      <span class="n">regression</span><span class="o">=</span><span class="n">regression</span><span class="p">,</span>
                                      <span class="n">keep_vectors</span><span class="o">=</span><span class="n">keep_vectors</span><span class="p">,</span>
                                      <span class="n">max_time</span><span class="o">=</span><span class="n">max_time</span><span class="p">,</span>
                                      <span class="n">steps</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                      <span class="n">retraining_needed</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                      <span class="n">use_list</span><span class="o">=</span><span class="n">use_list</span><span class="p">,</span>
                                      <span class="n">multinomial</span><span class="o">=</span><span class="n">multinomial</span><span class="p">,</span>
                                      <span class="n">classifier_information</span><span class="o">=</span><span class="p">{},</span>
                                      
                                      <span class="n">add_type</span><span class="o">=</span><span class="n">add_type</span><span class="p">,</span>
                                      <span class="n">discard_type</span><span class="o">=</span><span class="n">discard_type</span><span class="p">,</span>
                                      <span class="n">keep_only_sv</span><span class="o">=</span><span class="n">keep_only_sv</span><span class="p">,</span>
                                      <span class="n">basket_size</span><span class="o">=</span><span class="n">basket_size</span><span class="p">,</span>
                                      <span class="n">relabel</span><span class="o">=</span><span class="n">relabel</span><span class="p">,</span>
                                      <span class="n">border_handling</span><span class="o">=</span><span class="n">border_handling</span><span class="p">,</span>
                                      <span class="n">scale_factor_small</span><span class="o">=</span><span class="n">scale_factor_small</span><span class="p">,</span>
                                      <span class="n">scale_factor_tall</span><span class="o">=</span><span class="n">scale_factor_tall</span><span class="p">,</span>
                                      <span class="n">p_threshold</span><span class="o">=</span><span class="n">p_threshold</span><span class="p">,</span>
                                      <span class="n">u_retrain</span><span class="o">=</span><span class="n">u_retrain</span><span class="p">,</span>

                                      <span class="n">cdt_threshold</span><span class="o">=</span><span class="n">cdt_threshold</span><span class="p">,</span>

                                      <span class="n">training_set_ratio</span><span class="o">=</span><span class="n">training_set_ratio</span><span class="p">,</span>

                                      <span class="n">show_plot</span><span class="o">=</span><span class="n">show_plot</span><span class="p">,</span>
                                      <span class="n">save_plot</span><span class="o">=</span><span class="n">save_plot</span><span class="p">,</span>
                                      <span class="n">plot_storage</span><span class="o">=</span><span class="n">plot_storage</span><span class="p">,</span>

                                      <span class="n">scat</span><span class="o">=</span><span class="n">scat</span><span class="p">,</span>
                                      <span class="n">scatStandard</span><span class="o">=</span><span class="n">scatStandard</span><span class="p">,</span>
                                      <span class="n">scatTarget</span><span class="o">=</span><span class="n">scatTarget</span><span class="p">,</span>
                                      <span class="n">surf</span><span class="o">=</span><span class="n">surf</span><span class="p">,</span>
                                      <span class="n">is_retraining</span><span class="o">=</span><span class="n">is_retraining</span><span class="p">,</span>
                                      <span class="n">is_trained</span><span class="o">=</span><span class="n">is_trained</span><span class="p">,</span>

                                      <span class="c1"># parameters for circles around</span>
                                      <span class="c1"># first and second class</span>
                                      <span class="n">circleTarget0</span><span class="o">=</span><span class="n">circleTarget0</span><span class="p">,</span>
                                      <span class="n">circleTarget1</span><span class="o">=</span><span class="n">circleTarget1</span><span class="p">,</span>
                                      <span class="n">circleStandard0</span><span class="o">=</span><span class="n">circleStandard0</span><span class="p">,</span>
                                      <span class="n">circleStandard1</span><span class="o">=</span><span class="n">circleStandard1</span><span class="p">,</span>
                                      
                                      <span class="n">m_counter_i</span><span class="o">=</span><span class="n">m_counter_i</span><span class="p">,</span>

                                      <span class="c1"># collection of classification scores</span>
                                      <span class="c1"># for probability fits</span>
                                      <span class="n">decisions</span><span class="o">=</span><span class="p">[],</span>
                                      
                                      <span class="n">is_plot_active</span><span class="o">=</span><span class="n">is_plot_active</span><span class="p">,</span>
                                      <span class="p">)</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.stop_training"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.stop_training">[docs]</a>    <span class="k">def</span> <span class="nf">stop_training</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Wrapper around stop training for measuring times &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s2">&quot;No training data given to classification node (</span><span class="si">%s</span><span class="s2">), &quot;</span>
                      <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">+</span> <span class="s2">&quot;wrong class labels &quot;</span>
                      <span class="o">+</span> <span class="s2">&quot;used or your classifier is not using samples.&quot;</span><span class="p">,</span>
                        <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
        <span class="n">start_time_stamp</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RegularizedClassifierBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">stop_training</span><span class="p">()</span>
        <span class="n">stop_time_stamp</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;Training_time(classifier)&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Training_time(classifier)&quot;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">stop_time_stamp</span> <span class="o">-</span> <span class="n">start_time_stamp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Training_time(classifier)&quot;</span><span class="p">]</span> <span class="o">+=</span> \
                <span class="n">stop_time_stamp</span> <span class="o">-</span> <span class="n">start_time_stamp</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.is_trainable"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.is_trainable">[docs]</a>    <span class="k">def</span> <span class="nf">is_trainable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns whether this node is trainable &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">True</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.is_supervised"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.is_supervised">[docs]</a>    <span class="k">def</span> <span class="nf">is_supervised</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns whether this node requires supervised training &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">True</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.delete_training_data"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.delete_training_data">[docs]</a>    <span class="k">def</span> <span class="nf">delete_training_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if training data can be deleted to save memory &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keep_vectors</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_retrainable</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.__getstate__"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.__getstate__">[docs]</a>    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return a pickable state for this object &quot;&quot;&quot;</span>
        <span class="n">odict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">RegularizedClassifierBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s1">&#39;LINEAR&#39;</span><span class="p">:</span>
            <span class="c1"># if &#39;labels&#39; in odict:</span>
            <span class="c1">#     odict[&#39;labels&#39;] = []</span>
            <span class="c1"># if &#39;samples&#39; in odict:</span>
            <span class="c1">#     odict[&#39;samples&#39;] = []</span>
            <span class="k">if</span> <span class="s1">&#39;model&#39;</span> <span class="ow">in</span> <span class="n">odict</span><span class="p">:</span> 
                <span class="k">del</span> <span class="n">odict</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;model&#39;</span> <span class="ow">in</span> <span class="n">odict</span><span class="p">:</span> 
                <span class="k">del</span> <span class="n">odict</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">odict</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.store_state"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.store_state">[docs]</a>    <span class="k">def</span> <span class="nf">store_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result_dir</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span> 
        <span class="sd">&quot;&quot;&quot; Stores this node in the given directory *result_dir* &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s1">&#39;LINEAR&#39;</span><span class="p">:</span>
            <span class="n">node_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
            <span class="kn">from</span> <span class="nn">pySPACE.tools.filesystem</span> <span class="kn">import</span> <span class="n">create_directory</span>
            <span class="n">create_directory</span><span class="p">(</span><span class="n">node_dir</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">features</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span> <span class="o">==</span> <span class="n">FeatureVector</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="n">FeatureVector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># This node stores the learned features</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_sp</span><span class="si">%s</span><span class="s2">.pickle&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_split</span><span class="p">)</span>
                <span class="n">result_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">node_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
                <span class="n">result_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cPickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
                <span class="n">result_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_sp</span><span class="si">%s</span><span class="s2">.yaml&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_split</span><span class="p">)</span>
                <span class="n">result_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">node_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
                <span class="n">result_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">))</span>
                <span class="n">result_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.__setstate__"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.__setstate__">[docs]</a>    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sdict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Restore object from its pickled state &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RegularizedClassifierBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setstate__</span><span class="p">(</span><span class="n">sdict</span><span class="p">)</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">!=</span> <span class="s1">&#39;LINEAR&#39;</span><span class="p">:</span>
            <span class="c1"># Retraining the svm is not a semantically clean way of restoring</span>
            <span class="c1"># an object but its by far the most simple solution </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s2">&quot;Requires retraining of the classifier&quot;</span><span class="p">)</span> 
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_complete_training</span><span class="p">()</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.get_sensor_ranking"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.get_sensor_ranking">[docs]</a>    <span class="k">def</span> <span class="nf">get_sensor_ranking</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Transform the classification vector to a sensor ranking</span>

<span class="sd">        This method will fail, if the classification vector variable</span>
<span class="sd">        ``self.features`` is not existing.</span>
<span class="sd">        This is for example the case when using nonlinear classification with</span>
<span class="sd">        kernels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s2">&quot;features&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="n">FeatureVector</span><span class="p">(</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s2">&quot;No features variable existing to create generic sensor &quot;</span>
                <span class="s2">&quot;ranking in </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
        <span class="c1"># channel name is what comes after the first underscore</span>
        <span class="n">feat_channel_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">chnames</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                              <span class="k">for</span> <span class="n">chnames</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">feature_names</span><span class="p">]</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
        <span class="n">ranking_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="n">ranking_dict</span><span class="p">[</span><span class="n">feat_channel_names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="n">ranking</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ranking_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ranking</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase._train"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase._train">[docs]</a>    <span class="k">def</span> <span class="nf">_train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add a new sample with associated label to the training set.</span>
<span class="sd">        </span>
<span class="sd">            In case of neither incremental learning nor the</span>
<span class="sd">            restriction of training samples is used,</span>
<span class="sd">            add the samples to the training set.</span>
<span class="sd">            Otherwise check whether the classifier is already trained and if so</span>
<span class="sd">            select an appropriate training set and retrain the classifier.</span>
<span class="sd">            If the classifier is not trained, train it when there are enough</span>
<span class="sd">            samples available.</span>
<span class="sd">            </span>
<span class="sd">            :param data:  A new sample for the training set.</span>
<span class="sd">            :type  data:  list of float</span>
<span class="sd">            :param class_label:    The label of the new sample.</span>
<span class="sd">            :type  class_label:    str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_retrainable</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">basket_size</span> <span class="o">==</span> <span class="n">numpy</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_train_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># should not be relevant because first the classifier will be</span>
            <span class="c1"># trained if the basket size is reached but after the first training</span>
            <span class="c1"># only inc_train should adapt the classifier no matter how many</span>
            <span class="c1"># samples are in the training set</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">adapt_training_set</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_train_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_plot</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_plot</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basket_size</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_complete_training</span><span class="p">()</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;CDT&quot;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">learn_CDT</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span> <span class="o">=</span> <span class="bp">True</span></div>
                    
<div class="viewcode-block" id="RegularizedClassifierBase._train_sample"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase._train_sample">[docs]</a>    <span class="k">def</span> <span class="nf">_train_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Train the classifier on the given data sample</span>
<span class="sd">        </span>
<span class="sd">            It is assumed that the class_label parameter</span>
<span class="sd">            contains information about the true class the data belongs to.</span>
<span class="sd">        </span>
<span class="sd">            :param data:  A new sample for the training set.</span>
<span class="sd">            :type  data:  FeatureVector</span>
<span class="sd">            :param class_label:    The label of the new sample.</span>
<span class="sd">            :type  class_label:    str.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">feature_names</span>
            <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Use a feature generator node before a &quot;</span> <span class="o">+</span>
                              <span class="s2">&quot;classification node.&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">e</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="c1"># self.decision is by default set to empty list</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_type</span> <span class="o">==</span> <span class="s2">&quot;UNSUPERVISED_PROB&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">decisions</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;INC_BATCH&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">future_samples</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">future_labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">class_label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="ow">and</span> <span class="s2">&quot;REST&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="ow">and</span> \
                <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">regression</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Please give the expected classes to the classifier! &quot;</span> <span class="o">+</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> unknown. &quot;</span> <span class="o">%</span> <span class="n">class_label</span> <span class="o">+</span>
                <span class="s2">&quot;Therefore define the variable &#39;class_labels&#39; in &quot;</span> <span class="o">+</span>
                <span class="s2">&quot;your spec file, where you use your classifier. &quot;</span> <span class="o">+</span>
                <span class="s2">&quot;For further info look at the node documentation.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multinomial</span> <span class="ow">or</span> <span class="ow">not</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_label</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_permanent_attributes</span><span class="p">(</span><span class="n">classes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">)</span>
        <span class="c1"># main step of appending data to the list *self.samples*</span>
        <span class="k">if</span> <span class="n">class_label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">regression</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_sample</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">regression</span> <span class="ow">and</span> <span class="n">class_label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">class_label</span><span class="p">))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">regression</span> <span class="ow">and</span> <span class="s2">&quot;REST&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;REST&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">regression</span><span class="p">:</span>  <span class="c1"># regression!</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">class_label</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># one-class-classification is regression-like</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># case, where data is irrelevant</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.train"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.train">[docs]</a>    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Special mapping for multi-class classification</span>

<span class="sd">        It enables label filtering for one vs. REST and one vs. one case.</span>
<span class="sd">        Furthermore, the method measures time for the training segments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># one vs. REST case</span>
        <span class="k">if</span> <span class="s2">&quot;REST&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;REST&quot;</span>
        <span class="c1"># one vs. one case</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multinomial</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> \
                <span class="ow">not</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">start_time_stamp</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RegularizedClassifierBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="n">stop_time_stamp</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;Training_time(classifier)&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Training_time(classifier)&quot;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">stop_time_stamp</span> <span class="o">-</span> <span class="n">start_time_stamp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Training_time(classifier)&quot;</span><span class="p">]</span> <span class="o">+=</span> \
                <span class="n">stop_time_stamp</span> <span class="o">-</span> <span class="n">start_time_stamp</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.append_sample"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.append_sample">[docs]</a>    <span class="k">def</span> <span class="nf">append_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Some methods need a list of arrays as lists and some prefer arrays</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase._execute"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase._execute">[docs]</a>    <span class="k">def</span> <span class="nf">_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Executes the classifier on the given data vector in the linear case</span>
<span class="sd">        </span>
<span class="sd">        prediction value = &lt;w,data&gt;+b</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s1">&#39;LINEAR&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
            <span class="c1"># Let the SVM classify the given data: &lt;w,data&gt;+b</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">prediction_value</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prediction_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]))</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
            <span class="c1"># one-class multinomial handling of REST class</span>
            <span class="k">if</span> <span class="s2">&quot;REST&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">multinomial</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;REST&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;REST&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">prediction_value</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="c1"># Look up class label</span>
            <span class="c1"># prediction_value --&gt; {-1,1} --&gt; {0,1} --&gt; Labels</span>
            <span class="k">elif</span> <span class="n">prediction_value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="k">return</span> <span class="n">PredictionVector</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">prediction</span><span class="o">=</span><span class="n">prediction_value</span><span class="p">,</span>
                                    <span class="n">predictor</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.get_own_transformation"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.get_own_transformation">[docs]</a>    <span class="k">def</span> <span class="nf">get_own_transformation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Use classification function e.g. for visualization in LINEAR case</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s1">&#39;LINEAR&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_names</span><span class="p">,</span> <span class="s2">&quot;linear classifier&quot;</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase._inc_train"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase._inc_train">[docs]</a>    <span class="k">def</span> <span class="nf">_inc_train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Manipulation of training set for updating the svm &quot;&quot;&quot;</span>
        <span class="c1">#######################################################################</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;Inc_iterations&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Inc_iterations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Inc_iterations&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_retrain</span><span class="p">:</span>
            <span class="n">class_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">label</span>

        <span class="n">start_time_stamp</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
        <span class="c1">#######################################################################</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">adapt_training_set</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>

        <span class="c1">#######################################################################</span>
        <span class="n">stop_time_stamp</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;Retraining_time(classifier)&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Retraining_time(classifier)&quot;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="n">stop_time_stamp</span> <span class="o">-</span> <span class="n">start_time_stamp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Retraining_time(classifier)&quot;</span><span class="p">]</span> <span class="o">+=</span> \
                <span class="n">stop_time_stamp</span> <span class="o">-</span> <span class="n">start_time_stamp</span></div>
        <span class="c1">#######################################################################</span>

<div class="viewcode-block" id="RegularizedClassifierBase._batch_retrain"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase._batch_retrain">[docs]</a>    <span class="k">def</span> <span class="nf">_batch_retrain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data_list</span><span class="p">,</span> <span class="n">label_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Simply adding the new data to the old one an retraining &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">label_list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_train</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></div>
        <span class="c1"># # retraining is now performed in the train method, since method</span>
        <span class="c1"># # needs to be retrainable to call _batch_retrain</span>
        <span class="c1"># self.stop_training()</span>

<div class="viewcode-block" id="RegularizedClassifierBase.print_variables"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.print_variables">[docs]</a>    <span class="k">def</span> <span class="nf">print_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Debug function for printing the classifier and the slack variables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Precision does not work here because of the strange dtype. </span>
        <span class="n">numpy</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">edgeitems</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                               <span class="n">threshold</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="c1"># ...Setting the dtype to list doesn&#39;t work either.</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_w</span>
        <span class="k">print</span> <span class="s1">&#39;This is the classification vector w and b=&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_retained_features</span><span class="p">,</span> <span class="s1">&#39; out of &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> \
            <span class="s1">&#39; features have been used.&#39;</span>
        
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_sv</span><span class="p">,</span> <span class="s2">&quot; vectors of &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">,</span> <span class="s2">&quot; have been used.&quot;</span>
        <span class="c1"># print self.t, &quot;are the Slack variables.&quot;</span>
        
        <span class="k">if</span> <span class="ow">not</span><span class="p">((</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()):</span>
            <span class="k">print</span> <span class="s2">&quot;There are negative slack variables! Classification failed?&quot;</span>
        <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%i</span><span class="s2"> vectors of </span><span class="si">%i</span><span class="s2"> have been used for the inner margin and&quot;</span> \
                                    <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_margin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">)</span>
        <span class="n">numpy</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">edgeitems</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                               <span class="n">suppress</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="p">),</span> <span class="s2">&quot;are the inner Slack variables.&quot;</span>
        <span class="n">numpy</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">edgeitems</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">infstr</span><span class="o">=</span><span class="s1">&#39;Inf&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
                               <span class="n">nanstr</span><span class="o">=</span><span class="s1">&#39;NaN&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                               <span class="n">threshold</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.kernel_func"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.kernel_func">[docs]</a>    <span class="k">def</span> <span class="nf">kernel_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the kernel function applied on x and y </span>
<span class="sd">        </span>
<span class="sd">            - POLY         ::</span>
<span class="sd">            </span>
<span class="sd">                                (gamma*u&#39;*v + offset)^exponent</span>
<span class="sd">            - RBF          ::</span>
<span class="sd">            </span>
<span class="sd">                                exp(-gamma*|u-v|^2)</span>
<span class="sd">            - SIGMOID      ::</span>
<span class="sd">            </span>
<span class="sd">                                tanh(gamma*u&#39;*v + offset)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s2">&quot;LINEAR&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_gamma</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s2">&quot;LINEAR&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s2">&quot;POLY&quot;</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="o">*</span><span class="n">h</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">exponent</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s2">&quot;RBF&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">u</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s2">&quot;SIGMOID&quot;</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">*</span> <span class="n">h</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lambda &quot;</span><span class="p">):</span>
            <span class="n">function</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.calculate_gamma"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.calculate_gamma">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Calculate default gamma </span>
<span class="sd">        </span>
<span class="sd">        This defines a parameter for &#39;POLY&#39;-,&#39;RBF&#39;- and &#39;SIGMOID&#39;-kernel.</span>
<span class="sd">        We calculate the parameter `gamma` as described in the base node</span>
<span class="sd">        description.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s1">&#39;POLY&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s1">&#39;SIGMOID&#39;</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel_type</span> <span class="o">==</span> <span class="s1">&#39;RBF&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> \
                <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">regression</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">relevant</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">relevant</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">relevant_samples</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="n">relevant</span><span class="p">:</span>
                    <span class="n">relevant_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">variance</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">),</span>
                                              <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">/</span><span class="p">(</span><span class="n">variance</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s2">&quot;No parameter gamma specified for the kernel. Using: </span><span class="si">%f</span><span class="s2">.&quot;</span>\
                <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">,</span>
                <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.001</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.adapt_training_set"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.adapt_training_set">[docs]</a>    <span class="k">def</span> <span class="nf">adapt_training_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Select the samples that should belong to the training set and</span>
<span class="sd">            retrain the classifier.</span>
<span class="sd">            </span>
<span class="sd">            For incremental training run through four steps.</span>
<span class="sd">            </span>
<span class="sd">            1) Add samples to the training set according to some criteria.</span>
<span class="sd">            2) Discard samples from the training set according to some criteria.</span>
<span class="sd">            3) Retrain the classifier with the current training set.</span>
<span class="sd">            4) If used relabel the training set according to the current</span>
<span class="sd">               decision function.</span>
<span class="sd">            </span>
<span class="sd">            :param data:  A new sample for the training set.</span>
<span class="sd">            :type  data:  list of float</span>
<span class="sd">            :param class_label:    The label of the new sample.</span>
<span class="sd">            :type  class_label:    str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">show_plot</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_plot</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_plot_active</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_plot</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_plot</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_plot_active</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c1"># In case initial training is not already performed, train</span>
        <span class="c1"># classifier and CDT once.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span> <span class="o">==</span> <span class="bp">False</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">!=</span> <span class="s2">&quot;INC&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_complete_training</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;CDT&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">learn_CDT</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c1"># specify flag for retraining phase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_retraining</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c1">########################################################################</span>
        <span class="c1"># 1) Selection of new data                                             #</span>
        <span class="c1">########################################################################</span>

        <span class="p">[</span><span class="n">new_data_in_training_set</span><span class="p">,</span> <span class="n">retraining_required</span><span class="p">,</span> <span class="n">label</span><span class="p">]</span> <span class="o">=</span>\
            <span class="bp">self</span><span class="o">.</span><span class="n">select_new_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>

        <span class="c1">########################################################################</span>
        <span class="c1"># 2) Discard data                                                      #</span>
        <span class="c1">########################################################################</span>

        <span class="p">[</span><span class="n">new_data_in_training_set</span><span class="p">,</span> <span class="n">retraining_required</span><span class="p">]</span> <span class="o">=</span>\
            <span class="bp">self</span><span class="o">.</span><span class="n">discard_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">,</span>\
                              <span class="n">new_data_in_training_set</span><span class="p">,</span> <span class="n">retraining_required</span><span class="p">,</span>\
                              <span class="n">label</span><span class="p">)</span>

        <span class="c1">########################################################################</span>
        <span class="c1"># 3) Retrain                                                           #</span>
        <span class="c1">########################################################################</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">retrain</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">,</span>\
                     <span class="n">new_data_in_training_set</span><span class="p">,</span> <span class="n">retraining_required</span><span class="p">)</span>

        <span class="c1">########################################################################</span>
        <span class="c1"># 4) Relabel training set                                              #</span>
        <span class="c1">########################################################################</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">relabel_training_set</span><span class="p">()</span>
    
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_plot</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_plot</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="RegularizedClassifierBase.select_new_data"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.select_new_data">[docs]</a>    <span class="k">def</span> <span class="nf">select_new_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add the new sample to the training set if it satisfies some</span>
<span class="sd">            criteria.</span>
<span class="sd">            </span>
<span class="sd">            :param data:  A new sample for the training set.</span>
<span class="sd">            :type  data:  list of float</span>
<span class="sd">            :param class_label:    The label of the new sample.</span>
<span class="sd">            :type  class_label:    str</span>
<span class="sd">            :rtype: [flag if new data is in training set, flag if retraining is</span>
<span class="sd">                    required (the new point is a potential sv or a removed</span>
<span class="sd">                    one was a sv)]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret_label</span> <span class="o">=</span> <span class="bp">None</span>
        
        <span class="n">retraining_required</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">new_data_in_training_set</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_type</span> <span class="o">==</span> <span class="s2">&quot;ONLY_MISSCLASSIFIED&quot;</span><span class="p">:</span>
            <span class="c1"># get the prediction for the current data</span>
            <span class="n">predictionVec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="c1"># only append misclassified data points to training set</span>
            <span class="k">if</span> <span class="n">predictionVec</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span> <span class="n">class_label</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">!=</span> <span class="s2">&quot;INC&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_new_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>
                    <span class="n">ret_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">class_label</span><span class="p">)</span>
                    <span class="c1"># no need to check if potential support vector</span>
                    <span class="c1"># already confirmed with criteria</span>
                    <span class="n">retraining_required</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_data_in_training_set</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_type</span> <span class="o">==</span> <span class="s2">&quot;ADD_ALL&quot;</span><span class="p">:</span>
            <span class="c1"># add all incomming samples</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">!=</span> <span class="s2">&quot;INC&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_new_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>
                <span class="n">ret_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">class_label</span><span class="p">)</span>
                <span class="n">retraining_required</span> <span class="o">=</span>\
                    <span class="bp">self</span><span class="o">.</span><span class="n">is_potential_support_vector</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_data_in_training_set</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_type</span> <span class="o">==</span> <span class="s2">&quot;ONLY_WITHIN_MARGIN&quot;</span><span class="p">:</span>
            <span class="c1"># append only samples that are within the margin</span>
            <span class="c1"># (not on the other side of own border, but really between those</span>
            <span class="c1"># borderlines)</span>
            <span class="n">predictionVec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">predictionVec</span><span class="o">.</span><span class="n">prediction</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">!=</span> <span class="s2">&quot;INC&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_new_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>
                    <span class="n">ret_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">class_label</span><span class="p">)</span>
                    <span class="n">retraining_required</span> <span class="o">=</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">is_potential_support_vector</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_data_in_training_set</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_type</span> <span class="o">==</span> <span class="s2">&quot;UNSUPERVISED_PROB&quot;</span><span class="p">:</span>
            <span class="c1"># unsupervised classification</span>
            <span class="c1"># only append those samples that were most probably right</span>
            <span class="c1"># classified</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decisions</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">):</span>
                <span class="n">predictionVec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span>\
                                    <span class="n">numpy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">decisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predictionVec</span><span class="o">.</span><span class="n">prediction</span><span class="p">)</span>
            <span class="c1"># get number of target and standard samples</span>
            <span class="n">prior1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">))</span>
            <span class="n">prior0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">-</span> <span class="n">prior1</span>
            <span class="c1"># get labels as list of trues and falses</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
             
            <span class="c1"># calculate the label and the probability for the label of the</span>
            <span class="c1"># given data</span>
            <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_platt_prob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decisions</span><span class="p">,</span>
                                             <span class="n">labels</span><span class="p">,</span>
                                             <span class="n">prior1</span><span class="p">,</span> <span class="n">prior0</span><span class="p">,</span>
                                             <span class="n">data</span><span class="p">)</span>
             
            <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_threshold</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">decisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">!=</span> <span class="s2">&quot;INC&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_new_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
                    <span class="n">ret_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                    <span class="n">retraining_required</span> <span class="o">=</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">is_potential_support_vector</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_data_in_training_set</span> <span class="o">=</span> <span class="bp">True</span>
                    
        <span class="k">return</span> <span class="p">[</span><span class="n">new_data_in_training_set</span><span class="p">,</span> <span class="n">retraining_required</span><span class="p">,</span> <span class="n">ret_label</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.discard_data"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.discard_data">[docs]</a>    <span class="k">def</span> <span class="nf">discard_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">,</span>\
                     <span class="n">new_data_in_training_set</span><span class="p">,</span> <span class="n">retraining_required</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Discard data from training set according to some criteria.</span>
<span class="sd">        </span>
<span class="sd">            :param data:  A new sample for the training set.</span>
<span class="sd">            :type  data:  list of float</span>
<span class="sd">            :param class_label:    The label of the new sample.</span>
<span class="sd">            :type  class_label:    str</span>
<span class="sd">            :param new_data_in_training_set: flag if new data is in training set</span>
<span class="sd">            :type  new_data_in_training_set: bool</span>
<span class="sd">            :param retraining_required: flag if retraining is</span>
<span class="sd">                    requiered (the new point is a potentiell sv or a removed</span>
<span class="sd">                    one was a sv)</span>
<span class="sd">            :type  retraining_required: bool</span>
<span class="sd">            :rtype: [flag if new data is in training set, flag if retraining is</span>
<span class="sd">                    requiered (the new point is a potentiell sv or a removed</span>
<span class="sd">                    one was a sv)]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Reset retraining_required flag if a new chunk is not full</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;INC_BATCH&quot;</span>\
            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">future_samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">basket_size</span><span class="p">:</span>
            <span class="n">retraining_required</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">basket_size</span>\
            <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span><span class="o">==</span><span class="s2">&quot;REMOVE_OLDEST&quot;</span>\
                 <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span><span class="o">==</span><span class="s2">&quot;REMOVE_FARTHEST&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;REMOVE_OLDEST&quot;</span><span class="p">:</span>
                <span class="c1"># remove the oldest sample</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="c1"># in case &quot;DONT_HANDLE_RATIO&quot;</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_set_ratio</span> <span class="o">==</span> <span class="s2">&quot;KEEP_RATIO_AS_IT_IS&quot;</span><span class="p">:</span>
                    <span class="c1"># choose from the training set the oldest sample with the</span>
                    <span class="c1"># same label as the added sample</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">))</span>\
                                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">label</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_set_ratio</span> <span class="o">==</span> <span class="s2">&quot;BALANCED_RATIO&quot;</span><span class="p">:</span>
                    <span class="c1"># try to keep the number of samples for each class equal</span>
                    <span class="n">num_target</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
                    <span class="n">num_standard</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">num_target</span> <span class="o">!=</span> <span class="n">num_standard</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_target</span> <span class="o">&gt;</span> <span class="n">num_standard</span><span class="p">)</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">))</span>\
                                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">label</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">retraining_required</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_samples</span><span class="p">([</span><span class="n">idx</span><span class="p">])</span>\
                    <span class="ow">or</span> <span class="n">retraining_required</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;REMOVE_FARTHEST&quot;</span><span class="p">:</span>
                <span class="c1"># remove the sample which distance is maximal to the</span>
                <span class="c1"># hyperplane</span>
                <span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples</span>  <span class="c1"># in case &quot;DONT_HANDLE_RATIO&quot;</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_set_ratio</span> <span class="o">==</span> <span class="s2">&quot;KEEP_RATIO_AS_IT_IS&quot;</span><span class="p">:</span>
                    <span class="c1"># choose only from that samples with the same label as the</span>
                    <span class="c1"># added sample</span>
                    <span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">idxs_label</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">label</span><span class="p">:</span>
                            <span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                            <span class="n">idxs_label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_set_ratio</span> <span class="o">==</span> <span class="s2">&quot;BALANCED_RATIO&quot;</span><span class="p">:</span>
                    <span class="c1"># try to keep the number of samples for each class equal</span>
                    <span class="n">num_target</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
                    <span class="n">num_standard</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">num_target</span> <span class="o">!=</span> <span class="n">num_standard</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_target</span> <span class="o">&gt;</span> <span class="n">num_standard</span><span class="p">)</span>
                    
                    <span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">idxs_label</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">label</span><span class="p">:</span>
                            <span class="n">samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                            <span class="n">idxs_label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

                <span class="n">idx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span>\
                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span>\
                            <span class="n">numpy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">.</span><span class="n">prediction</span><span class="p">),</span>\
                        <span class="n">samples</span><span class="p">))</span>
                
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_set_ratio</span> <span class="o">==</span> <span class="s2">&quot;KEEP_RATIO_AS_IT_IS&quot;</span> <span class="ow">or</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">training_set_ratio</span> <span class="o">==</span> <span class="s2">&quot;BALANCED_RATIO&quot;</span><span class="p">:</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="n">idxs_label</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                
                <span class="n">retraining_required</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_samples</span><span class="p">([</span><span class="n">idx</span><span class="p">])</span>\
                    <span class="ow">or</span> <span class="n">retraining_required</span>
                 
        <span class="c1"># TODO: add parameter to specify possible overlap</span>
        <span class="c1">#       like x times basket size?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;INC_BATCH&quot;</span>\
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">future_samples</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">basket_size</span><span class="p">:</span>
            <span class="c1"># remove all old samples</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_samples</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">)))</span>
            <span class="c1"># and add all samples from the future knowledge base</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">c_l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">future_samples</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">future_labels</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_new_sample</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">c_l</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
            <span class="c1"># The whole training set changes so retraining is required</span>
            <span class="n">retraining_required</span> <span class="o">=</span> <span class="bp">True</span>
 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;REMOVE_NO_BORDER_POINTS&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">basket_size</span><span class="p">:</span>
                <span class="c1"># Don&#39;t retrain if basket size is not reached</span>
                <span class="n">retraining_required</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">basket_size</span><span class="p">:</span>
                <span class="c1"># Retrain if basket size is reached</span>
                <span class="n">retraining_required</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">basket_size</span><span class="p">:</span>
                <span class="c1"># Discard useless data for next iterations</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_no_border_points</span><span class="p">(</span><span class="n">retraining_required</span><span class="p">)</span>
                <span class="n">retraining_required</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;CDT&quot;</span><span class="p">:</span>
            <span class="c1"># test if a change occurred</span>
            <span class="n">changeDetected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_detection_test</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>
            <span class="c1"># if a change is detected remove old samples</span>
            <span class="k">if</span> <span class="n">changeDetected</span> <span class="ow">or</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">floor_divide</span><span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">future_samples</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdt_threshold</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_samples</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)))</span>
                <span class="c1"># if a change is detected or many new samples arrived add</span>
                <span class="c1"># current samples to training set</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">future_samples</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">future_labels</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_new_sample</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
                <span class="n">retraining_required</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">retraining_required</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">new_data_in_training_set</span><span class="p">,</span> <span class="n">retraining_required</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.retrain"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.retrain">[docs]</a>    <span class="k">def</span> <span class="nf">retrain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">,</span>
                <span class="n">new_data_in_training_set</span><span class="p">,</span> <span class="n">retraining_required</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Start retraining procedure if the training set changed.</span>
<span class="sd">        </span>
<span class="sd">            :param data:  A new sample for the training set.</span>
<span class="sd">            :type  data:  list of float</span>
<span class="sd">            :param class_label:    The label of the new sample.</span>
<span class="sd">            :type  class_label:    str</span>
<span class="sd">            :param new_data_in_training_set: flag if new data is in training set</span>
<span class="sd">            :type  new_data_in_training_set: bool</span>
<span class="sd">            :param retraining_required: flag if retraining is</span>
<span class="sd">                    required (the new point is a potential sv or a removed</span>
<span class="sd">                    one was a sv)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;Inc_iterations&quot;</span><span class="p">)</span> <span class="ow">and</span>\
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Inc_iterations&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Retrain_counter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;INC&quot;</span> <span class="ow">and</span> <span class="n">new_data_in_training_set</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c1"># Incremental training</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">incremental_training</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;Retrain_counter&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Retrain_counter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Retrain_counter&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">retraining_required</span><span class="p">:</span>
                <span class="c1"># retrain the svm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">retrain_SVM</span><span class="p">()</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s2">&quot;Retrain_counter&quot;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Retrain_counter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">classifier_information</span><span class="p">[</span><span class="s2">&quot;Retrain_counter&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keep_only_sv</span> <span class="ow">or</span>
                        <span class="c1"># approaches, where data is removed later on</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;CDT&quot;</span> <span class="ow">or</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;INC_BATCH&quot;</span><span class="p">):</span>
                    <span class="c1"># only keep the sv to save memory</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">remove_non_support_vectors</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.relabel_training_set"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.relabel_training_set">[docs]</a>    <span class="k">def</span> <span class="nf">relabel_training_set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Relabel the training set according to the current decision function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">iterations</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">relabel</span><span class="p">:</span>
            <span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="c1"># relabel all training samples according to</span>
            <span class="c1"># current decision function</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">)):</span>
                <span class="n">predictionVec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">predictionVec</span><span class="o">.</span><span class="n">label</span><span class="p">):</span>
                    <span class="n">changed</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">predictionVec</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
                    <span class="c1"># only relevant for SOR classification (outsourcing?)</span>
                    <span class="k">if</span> <span class="s2">&quot;version&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">):</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;matrix&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
                            <span class="c1"># modified from *calculate_weigts_and_class_factors*</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span> <span class="s2">&quot;matrix&quot;</span><span class="p">]:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">bi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ci</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">complexity</span> <span class="o">*</span> \
                                    <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decisions</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">decisions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictionVec</span><span class="o">.</span><span class="n">prediction</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">decisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predictionVec</span><span class="o">.</span><span class="n">prediction</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">changed</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># Retrain the svm with the relabeled training set</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">retrain_SVM</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">relabel</span> <span class="o">==</span> <span class="s2">&quot;conv&quot;</span> <span class="ow">or</span> <span class="n">iterations</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.is_potential_support_vector"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.is_potential_support_vector">[docs]</a>    <span class="k">def</span> <span class="nf">is_potential_support_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check whether the given data could become a support vector</span>
<span class="sd">           </span>
<span class="sd">            This is when the data is within, on or on the other side of the</span>
<span class="sd">            margin.</span>
<span class="sd">            </span>
<span class="sd">            :param data:  A new sample for the training set.</span>
<span class="sd">            :type  data:  list of float</span>
<span class="sd">            :param class_label:    The label of the new sample.</span>
<span class="sd">            :type  class_label:    str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">predictionVec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">class_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">class_label</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">predictionVec</span><span class="o">.</span><span class="n">prediction</span> <span class="o">&lt;=</span> <span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">predictionVec</span><span class="o">.</span><span class="n">prediction</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.remove_no_border_points"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.remove_no_border_points">[docs]</a>    <span class="k">def</span> <span class="nf">remove_no_border_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">retraining_required</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Discard method to remove all samples from the training set that are</span>
<span class="sd">            not in the border of their class.</span>
<span class="sd">            </span>
<span class="sd">            The border is determined by a minimum distance from the center of</span>
<span class="sd">            the class and a maximum distance.</span>
<span class="sd">        </span>
<span class="sd">            :param retraining_required: flag if retraining is</span>
<span class="sd">                    required (the new point is a potential sv or a removed</span>
<span class="sd">                    one was a sv)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;The node </span><span class="si">%s</span><span class="s2"> does not implement a border point handling.&quot;</span> \
            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.add_new_sample"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.add_new_sample">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add a new sample to the training set</span>
<span class="sd">        </span>
<span class="sd">            :param data:  A new sample for the training set.</span>
<span class="sd">            :type  data:  list of float</span>
<span class="sd">            :param class_label:    The label of the new sample.</span>
<span class="sd">            :type  class_label:    str</span>
<span class="sd">            :param default:  Specifies if the sample is added to the current</span>
<span class="sd">                             training set or to a future training set</span>
<span class="sd">            :param default:  bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;The node </span><span class="si">%s</span><span class="s2"> does not implement a add sample routine.&quot;</span> \
            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="RegularizedClassifierBase.remove_samples"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.remove_samples">[docs]</a>    <span class="k">def</span> <span class="nf">remove_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Remove the samples at the given indices from the training set</span>
<span class="sd">        </span>
<span class="sd">            :param: idxs: Indices of the samples to remove.</span>
<span class="sd">            :type:  idxs: list of int</span>
<span class="sd">            :rtype: bool - True if a support vector was removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;The node </span><span class="si">%s</span><span class="s2"> does not implement a remove sample routine.&quot;</span> \
            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.remove_non_support_vectors"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.remove_non_support_vectors">[docs]</a>    <span class="k">def</span> <span class="nf">remove_non_support_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Remove all samples that are no support vectors &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;The node </span><span class="si">%s</span><span class="s2"> does not implement a remove SVs routine.&quot;</span> \
            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.retrain_SVM"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.retrain_SVM">[docs]</a>    <span class="k">def</span> <span class="nf">retrain_SVM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Retrain the svm with the current training set &quot;&quot;&quot;</span>
        <span class="c1"># start retraining process</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_complete_training</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">future_samples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">future_labels</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discard_type</span> <span class="o">==</span> <span class="s2">&quot;CDT&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">learn_CDT</span><span class="p">()</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.incremental_training"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.incremental_training">[docs]</a>    <span class="k">def</span> <span class="nf">incremental_training</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Warm Start Implementation by Mario Michael Krell</span>
<span class="sd"> </span>
<span class="sd">        The saved status of the algorithm, including the Matrix M, is used</span>
<span class="sd">        as a starting point for the iteration.</span>
<span class="sd">        Only the problem has to be lifted up one dimension.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;The node </span><span class="si">%s</span><span class="s2"> does not implement incremental training.&quot;</span> \
            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.learn_CDT"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.learn_CDT">[docs]</a>    <span class="k">def</span> <span class="nf">learn_CDT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Learn features of the training set to detect changes in the</span>
<span class="sd">            underlying distribution</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;The node </span><span class="si">%s</span><span class="s2"> does not implement a CDT.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="RegularizedClassifierBase.change_detection_test"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.change_detection_test">[docs]</a>    <span class="k">def</span> <span class="nf">change_detection_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">class_label</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Detect a change of the distribution</span>
<span class="sd">        </span>
<span class="sd">            :param data:  A new sample for the training set.</span>
<span class="sd">            :type  data:  list of float</span>
<span class="sd">            :param class_label:    The label of the new sample.</span>
<span class="sd">            :type  class_label:    str</span>
<span class="sd">            :rtype: bool - If change detected return True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;The node </span><span class="si">%s</span><span class="s2"> does not implement a change detection test.&quot;</span> \
            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.get_platt_prob"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.get_platt_prob">[docs]</a>    <span class="k">def</span> <span class="nf">get_platt_prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deci</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">prior1</span><span class="p">,</span> <span class="n">prior0</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get a probability for the decision of the svm</span>
<span class="sd">        </span>
<span class="sd">            :param deci: List of decision made for each sample.</span>
<span class="sd">            :type  deci: list of float</span>
<span class="sd">            :param label: List of labels from the previous samples.</span>
<span class="sd">            :type  label: list of bool</span>
<span class="sd">            :param prior1: Number of samples of class 1</span>
<span class="sd">            :type  prior1: int</span>
<span class="sd">            :param prior0: Number of samples of class 0</span>
<span class="sd">            :type  prior0: int</span>
<span class="sd">            :param data: Sample under investigation</span>
<span class="sd">            :type  data: list of float</span>
<span class="sd">            :rtype: [float, int] - probability and the corresponding label</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approximate_AB_for_plat_prob</span><span class="p">(</span><span class="n">deci</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">prior1</span><span class="p">,</span> <span class="n">prior0</span><span class="p">)</span>
        
        <span class="n">predictionVec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">predictionVec</span><span class="o">.</span><span class="n">prediction</span>
        
        <span class="n">fApB</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span>
        <span class="k">if</span> <span class="n">fApB</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">fApB</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">fApB</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">fApB</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">predictionVec</span><span class="o">.</span><span class="n">label</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">predictionVec</span><span class="o">.</span><span class="n">label</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="n">predictionVec</span><span class="o">.</span><span class="n">label</span><span class="p">]</span></div>
        
<div class="viewcode-block" id="RegularizedClassifierBase.approximate_AB_for_plat_prob"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.approximate_AB_for_plat_prob">[docs]</a>    <span class="k">def</span> <span class="nf">approximate_AB_for_plat_prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deci</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">prior1</span><span class="p">,</span> <span class="n">prior0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Approximate the distribution of both classes</span>
<span class="sd">        </span>
<span class="sd">            :param deci: List of decision made for each sample.</span>
<span class="sd">            :type  deci: list of float</span>
<span class="sd">            :param label: List of labels from the previous samples.</span>
<span class="sd">            :type  label: list of bool</span>
<span class="sd">            :param prior1: Number of samples of class 1</span>
<span class="sd">            :type  prior1: int</span>
<span class="sd">            :param prior0: Number of samples of class 0</span>
<span class="sd">            :type  prior0: int    </span>
<span class="sd">            :rtype: [float, float] - ([A, B] - parameters of sigmoid)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Parameter setting</span>
        <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="c1"># Maximum number of iterations</span>
        <span class="n">minstep</span> <span class="o">=</span> <span class="mf">1e-10</span>
        <span class="c1"># Minimum step taken in line search</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="mf">1e-12</span>
        <span class="c1"># Set to any value &gt; 0</span>
        <span class="c1"># Construct initial values:    target support in array t,</span>
        <span class="c1">#                              initial function value in fval</span>
        <span class="n">hiTarget</span> <span class="o">=</span> <span class="p">(</span><span class="n">prior1</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">prior1</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="n">loTarget</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">prior0</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="n">prior1</span> <span class="o">+</span> <span class="n">prior0</span>  <span class="c1"># Total number of data</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">label</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hiTarget</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">loTarget</span>
        
        <span class="n">A</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">prior0</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">prior1</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">))</span>
        <span class="n">fval</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
            <span class="n">fApB</span> <span class="o">=</span> <span class="n">deci</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span>
            <span class="k">if</span> <span class="n">fApB</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">fval</span> <span class="o">+=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">fApB</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">fApB</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fval</span> <span class="o">+=</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fApB</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">fApB</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
            <span class="c1"># Update Gradient and Hessian (use H&#39; = H + sigma 1)</span>
            <span class="n">h11</span> <span class="o">=</span> <span class="n">h22</span> <span class="o">=</span> <span class="n">sigma</span>
            <span class="n">h21</span> <span class="o">=</span> <span class="n">g1</span> <span class="o">=</span> <span class="n">g2</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
                <span class="n">fApB</span> <span class="o">=</span> <span class="n">deci</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span>
                <span class="k">if</span> <span class="n">fApB</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">fApB</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">fApB</span><span class="p">))</span>
                    <span class="n">q</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">fApB</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">fApB</span><span class="p">))</span>
                    <span class="n">q</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">fApB</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">fApB</span><span class="p">))</span>
                <span class="n">d2</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
                <span class="n">h11</span> <span class="o">+=</span> <span class="n">deci</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">deci</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">d2</span>
                <span class="n">h22</span> <span class="o">+=</span> <span class="n">d2</span>
                <span class="n">h21</span> <span class="o">+=</span> <span class="n">deci</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">d2</span>
                <span class="n">d1</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span>
                <span class="n">g1</span> <span class="o">+=</span> <span class="n">deci</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">d1</span>
                <span class="n">g2</span> <span class="o">+=</span> <span class="n">d1</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">g1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-5</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">g2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">:</span>  <span class="c1"># Stopping criteria</span>
                <span class="k">break</span>
            <span class="c1"># Compute modified Newton directions</span>
            <span class="n">det</span> <span class="o">=</span> <span class="n">h11</span> <span class="o">*</span> <span class="n">h22</span> <span class="o">-</span> <span class="n">h21</span> <span class="o">*</span> <span class="n">h21</span>
            <span class="n">dA</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">h22</span> <span class="o">*</span> <span class="n">g1</span> <span class="o">-</span> <span class="n">h21</span> <span class="o">*</span> <span class="n">g2</span><span class="p">)</span> <span class="o">/</span> <span class="n">det</span>
            <span class="n">dB</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">h21</span> <span class="o">*</span> <span class="n">g1</span> <span class="o">+</span> <span class="n">h11</span> <span class="o">*</span> <span class="n">g2</span><span class="p">)</span> <span class="o">/</span> <span class="n">det</span>
            <span class="n">gd</span> <span class="o">=</span> <span class="n">g1</span> <span class="o">*</span> <span class="n">dA</span> <span class="o">+</span> <span class="n">g2</span> <span class="o">*</span> <span class="n">dB</span>
            <span class="n">stepsize</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">stepsize</span> <span class="o">&gt;=</span> <span class="n">minstep</span><span class="p">:</span>  <span class="c1"># Line search</span>
                <span class="n">newA</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">stepsize</span> <span class="o">*</span> <span class="n">dA</span>
                <span class="n">newB</span> <span class="o">=</span> <span class="n">B</span> <span class="o">+</span> <span class="n">stepsize</span> <span class="o">*</span> <span class="n">dB</span>
                <span class="n">newf</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
                    <span class="n">fApB</span> <span class="o">=</span> <span class="n">deci</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">newA</span> <span class="o">+</span> <span class="n">newB</span>
                    <span class="k">if</span> <span class="n">fApB</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">newf</span> <span class="o">+=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">fApB</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">fApB</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">newf</span> <span class="o">+=</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fApB</span> <span class="o">+</span> \
                            <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">fApB</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">newf</span> <span class="o">&lt;</span> <span class="n">fval</span> <span class="o">+</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">stepsize</span> <span class="o">*</span> <span class="n">gd</span><span class="p">:</span>
                    <span class="n">A</span> <span class="o">=</span> <span class="n">newA</span>
                    <span class="n">B</span> <span class="o">=</span> <span class="n">newB</span>
                    <span class="n">fval</span> <span class="o">=</span> <span class="n">newf</span>
                    <span class="k">break</span>  <span class="c1"># Sufficient decrease satisfied</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stepsize</span> <span class="o">/=</span> <span class="mf">2.0</span>
            <span class="k">if</span> <span class="n">stepsize</span> <span class="o">&lt;</span> <span class="n">minstep</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                    <span class="s2">&quot;Line search fails. A= &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; B= &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">B</span><span class="p">),</span>
                    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">it</span> <span class="o">&gt;=</span> <span class="n">maxiter</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s2">&quot;Reaching maximal iterations&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">]</span></div>

<span class="c1"># ------------------------------------------------------------------------------</span>
<span class="c1"># plot routines</span>
<span class="c1"># ------------------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">__intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Calculate the points of a line in a given rectangle</span>
<span class="sd">            </span>
<span class="sd">            :param rect: Parameters of a rectangle (min x, min y, max x, max y).</span>
<span class="sd">            :type  rect: list of float</span>
<span class="sd">            :param line: line given as y=a*x+b or a*x+b*y+c=0</span>
<span class="sd">            :type  line: list of float</span>
<span class="sd">            :rtype: list of pairs of float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">rect</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">line</span>

        <span class="k">assert</span> <span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">!=</span> <span class="mi">0</span>
    
        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="o">/</span><span class="n">b</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">ymax</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">ymin</span><span class="p">:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">xmin</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
                <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">xmax</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">l</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="o">/</span><span class="n">a</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">xmax</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">xmin</span><span class="p">:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">ymin</span><span class="p">))</span>
                <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">ymax</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">l</span>
    
        <span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
        <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span> <span class="o">/</span> <span class="n">b</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">m</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">ymax</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">ymin</span><span class="p">:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
    
        <span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span> <span class="o">/</span> <span class="n">a</span>
        <span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span> <span class="o">/</span> <span class="n">a</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">m</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">xmax</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">xmin</span><span class="p">:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">l</span>

<div class="viewcode-block" id="RegularizedClassifierBase.plot_line"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.plot_line">[docs]</a>    <span class="k">def</span> <span class="nf">plot_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coef</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot a line (y=a*x+b or a*x+b*y+c=0) with the given coefficients</span>
<span class="sd">        </span>
<span class="sd">            :param coef: Coefficients determining the line</span>
<span class="sd">            :type  coef: list of floats</span>
<span class="sd">            :rtype: list of lines</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coef</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">coef</span><span class="p">[:])</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">coef</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">coef</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    
        <span class="n">limits</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
        <span class="n">points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__intersect</span><span class="p">(</span><span class="n">limits</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">pts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">l</span>
        <span class="k">return</span> <span class="bp">None</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.circle_out"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.circle_out">[docs]</a>    <span class="k">def</span> <span class="nf">circle_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Circle out points with size &#39;s&#39;.</span>
<span class="sd">        </span>
<span class="sd">            :param x: x coordinates.</span>
<span class="sd">            :type  x: list of float</span>
<span class="sd">            :param y: y coordinates.</span>
<span class="sd">            :type  y: list of float</span>
<span class="sd">            :param s: Size of circle</span>
<span class="sd">            :tyep  s: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">y</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;edgecolors&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scat</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.plot_data"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.plot_data">[docs]</a>    <span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot points with size &#39;s&#39;</span>
<span class="sd">        </span>
<span class="sd">            :param x: x coordinates.</span>
<span class="sd">            :type  x: list of float</span>
<span class="sd">            :param y: y coordinates.</span>
<span class="sd">            :type  y: list of float</span>
<span class="sd">            :param target: Determine class label.</span>
<span class="sd">            :type  target: bool</span>
<span class="sd">            :param s: Size of point.</span>
<span class="sd">            :type  s: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">y</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;edgecolors&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">target</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scatTarget</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>\
                                             <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>\
                                             <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;edgecolors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scatStandard</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>\
                                               <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>\
                                               <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.plot_hyperplane"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.plot_hyperplane">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hyperplane</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot the hyperplane (in 2D a line).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$wx + b = 0$</span><span class="se">\n</span><span class="s2">$[</span><span class="si">%.4f</span><span class="s2">; </span><span class="si">%.4f</span><span class="s2">]x + </span><span class="si">%.4f</span><span class="s2"> = 0$&quot;</span>\
                     <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">))</span>
        
        <span class="n">coef</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">]</span>
        
        <span class="n">coef1</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[:]</span>
        <span class="n">coef2</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[:]</span>
        <span class="n">coef1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> 
        <span class="n">coef2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_plot</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
                <span class="n">sleep</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="n">coef1</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_line</span><span class="p">(</span><span class="n">coef2</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="RegularizedClassifierBase.plot_samples"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.plot_samples">[docs]</a>    <span class="k">def</span> <span class="nf">plot_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot all training samples.</span>
<span class="sd">        </span>
<span class="sd">            Plot all training samples and mark the class association.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">class_neg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">class_pos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">class_neg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">class_pos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        
        <span class="n">class_neg</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">class_neg</span><span class="p">)</span>
        <span class="n">class_pos</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">class_pos</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatStandard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scatStandard</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scatStandard</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatTarget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scatTarget</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scatTarget</span> <span class="o">=</span> <span class="bp">None</span>
        
        <span class="c1"># TODO: determine size of plot</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span> <span class="c1">#min(numpy.min(class_neg[:,0]), numpy.min(class_pos[:,0]))</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="mf">2.5</span>  <span class="c1">#max(numpy.max(class_neg[:,0]), numpy.max(class_pos[:,0]))</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span> <span class="c1">#min(numpy.min(class_neg[:,1]), numpy.min(class_pos[:,1]))</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="mf">2.5</span>  <span class="c1">#max(numpy.max(class_neg[:,1]), numpy.max(class_pos[:,1]))</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">xmin</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ymin</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="mf">1.0</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">class_neg</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">class_neg</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">class_neg</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">class_pos</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">class_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">class_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="RegularizedClassifierBase.plot_support_vectors"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.plot_support_vectors">[docs]</a>    <span class="k">def</span> <span class="nf">plot_support_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Mark the support vectors by a circle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">support_vectors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_solution</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">support_vectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        
        <span class="n">support_vectors</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">support_vectors</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scat</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    
        <span class="k">if</span> <span class="n">support_vectors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">support_vectors</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span>\
            <span class="n">numpy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">support_vectors</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">circle_out</span><span class="p">(</span><span class="n">support_vectors</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">support_vectors</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scat</span> <span class="o">=</span> <span class="bp">None</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.plot_class_borders"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.plot_class_borders">[docs]</a>    <span class="k">def</span> <span class="nf">plot_class_borders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mStandard</span><span class="p">,</span> <span class="n">mTarget</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span>
                           <span class="n">scaleFactorSmall</span><span class="p">,</span> <span class="n">scaleFactorTall</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot the borders of each class.</span>
<span class="sd">            </span>
<span class="sd">            :param mStandard: Center of standard class.</span>
<span class="sd">            :type  mStandard: [float, float] - (x,y)</span>
<span class="sd">            :param mTarget: Center of target class.</span>
<span class="sd">            :type  mTarget: [float, float] - (x,y)</span>
<span class="sd">            :param R: Distance between both centers.</span>
<span class="sd">            :type  R: float</span>
<span class="sd">            :param scaleFactorSmall: Determine inner circle of class border.</span>
<span class="sd">            :type  scaleFactorSmall: float</span>
<span class="sd">            :param scaleFactorTall: Determine outer circle of class border.</span>
<span class="sd">            :type  scaleFactorTall: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circleStandard0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">circleStandard0</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circleStandard1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">circleStandard1</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circleTarget0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">circleTarget0</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circleTarget1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">circleTarget1</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">circleStandard0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span>
            <span class="n">mStandard</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">scaleFactorSmall</span> <span class="o">*</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circleStandard1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span>
            <span class="n">mStandard</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">scaleFactorTall</span> <span class="o">*</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">circleTarget0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span>
            <span class="n">mTarget</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">scaleFactorSmall</span> <span class="o">*</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circleTarget1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span>
            <span class="n">mTarget</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">scaleFactorTall</span> <span class="o">*</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">circleStandard0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">circleStandard1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">circleTarget0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">circleTarget1</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.plot_data_3D"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.plot_data_3D">[docs]</a>    <span class="k">def</span> <span class="nf">plot_data_3D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot points with size &#39;s&#39;</span>
<span class="sd">        </span>
<span class="sd">            :param x: x coordinates.</span>
<span class="sd">            :type  x: list of float</span>
<span class="sd">            :param y: y coordinates.</span>
<span class="sd">            :type  y: list of float</span>
<span class="sd">            :param z: z coordinates:</span>
<span class="sd">            :type  z: list of float</span>
<span class="sd">            :param target: Determine class label.</span>
<span class="sd">            :type  target: bool</span>
<span class="sd">            :param s: Size of point.</span>
<span class="sd">            :type  s: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">y</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">z</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;edgecolors&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">target</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scatTarget</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span>  <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scatStandard</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span>  <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="RegularizedClassifierBase.plot_samples_3D"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.plot_samples_3D">[docs]</a>    <span class="k">def</span> <span class="nf">plot_samples_3D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot all training samples.</span>
<span class="sd">        </span>
<span class="sd">            Plot all training samples and mark the class association.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span><span class="c1">#generate 3d plot</span>

        <span class="c1"># TODO: determine size of plot</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span>  <span class="c1"># min(numpy.min(class_neg[:,0]), numpy.min(class_pos[:,0]))</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="mf">2.5</span>   <span class="c1"># max(numpy.max(class_neg[:,0]), numpy.max(class_pos[:,0]))</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span>  <span class="c1"># min(numpy.min(class_neg[:,1]), numpy.min(class_pos[:,1]))</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="mf">2.5</span>   <span class="c1"># max(numpy.max(class_neg[:,1]), numpy.max(class_pos[:,1]))</span>
        <span class="n">zmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span>
        <span class="n">zmax</span> <span class="o">=</span> <span class="mf">2.5</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim3d</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim3d</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">(</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">)</span>
        
        <span class="n">class_neg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">class_pos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">class_neg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">class_pos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        
        <span class="n">class_neg</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">class_neg</span><span class="p">)</span>
        <span class="n">class_pos</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">class_pos</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatStandard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scatStandard</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scatStandard</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scatTarget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scatTarget</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scatTarget</span> <span class="o">=</span> <span class="bp">None</span>
        
        <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">class_neg</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_data_3D</span><span class="p">(</span>
                <span class="n">class_neg</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">class_neg</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">class_neg</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">class_pos</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_data_3D</span><span class="p">(</span>
                <span class="n">class_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">class_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">class_pos</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="RegularizedClassifierBase.plot_hyperplane_3D"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.plot_hyperplane_3D">[docs]</a>    <span class="k">def</span> <span class="nf">plot_hyperplane_3D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot the hyperplane (in 3D a surface).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$wx + b = 0$</span><span class="se">\n</span><span class="s2">$[</span><span class="si">%.4f</span><span class="s2">; </span><span class="si">%.4f</span><span class="s2">; </span><span class="si">%.4f</span><span class="s2">]x + </span><span class="si">%.4f</span><span class="s2"> = 0$&quot;</span>\
                     <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">surf</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">surf</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="c1"># create x,y</span>
        <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>\
                                <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">))</span>
    
        <span class="c1"># calculate corresponding z</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">xx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">yy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="RegularizedClassifierBase.visualize"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.RegularizedClassifierBase.visualize">[docs]</a>    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Show the training samples, the support vectors if possible and the</span>
<span class="sd">            current decision function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;The node </span><span class="si">%s</span><span class="s2"> does not implement a&quot;</span><span class="o">+</span> \
                                  <span class="s2">&quot;visualization.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span></div></div>

<span class="c1"># ------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="TimeoutException"><a class="viewcode-back" href="../../../../../api/generated/pySPACE.missions.nodes.classification.base.html#pySPACE.missions.nodes.classification.base.TimeoutException">[docs]</a><span class="k">class</span> <span class="nc">TimeoutException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Break up for to long simplex iterations &quot;&quot;&quot;</span> 
    <span class="k">pass</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../index.html">pySPACE documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, pySPACE Developer Team.
      Last updated on Sep 04, 2016.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.2.
    </div>
  </body>
</html>